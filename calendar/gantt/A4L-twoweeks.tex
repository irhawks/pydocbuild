\documentclass[a4paper,landscape,14pt]{ctexart}
\usepackage[margin=0.5in,top=1in,bottom=0.05in]{geometry}
\usepackage{calc}

\usepackage{tikz}
\usetikzlibrary{shadows,shapes}
\usepackage{pgfgantt}

\usepackage{pgffor}

\usepackage{fancyhdr}
\pagestyle{fancy}
\lhead{}
\chead{}
\rhead{任务计划表}
\lfoot{From: }
\cfoot{To: }
\rfoot{\thepage}
\setlength{\headsep}{0pt}
\setlength{\footskip}{5pt}

\title{任务计划表}
\author{任呈祥}

\begin{document}

%\thispagestyle{empty}
%\maketitle


\ganttset{calendar week text={
    \pgfcalendarmonthshortname{\startmonth}~~\startyear,  Week \currentweek
}}

%%% 注意Week的数字表示当中，0表示星期一，1表示星期二，所以我们使用缩写名。
%%% 1/(6*7)  0.0238
%%% 1/(4*7)  0.0357
%%% 1/(2*7)  0.0714
%%% 1/(3*7)  0.0476
%%% 1/(1*7)  0.1428

\def\makegantt#1#2#3{
\begin{center}
\begin{ganttchart}[
%hgrid,
%vgrid,
hgrid={*1{draw=black!80},*4{draw=black!40,dashed}},
vgrid={*{6}{black!40, dotted},*1{black!80}},
x unit=0.0476\textwidth,
y unit chart=6mm,
y unit title=5mm,
time slot format=isodate,
bar/.append style={draw=blue!20,fill=red!10,opacity=0.5},
%title/.append style={draw=none, inner color=red, fill=blue!20, rounded corners=2mm, drop shadow}
title/.append style={draw=black!50,inner color=black!10, fill=blue!20, drop shadow},
canvas/.style={shape=chamfered rectangle, draw=black!60,dash dot,very thick}
]{#1}{#2}
%\gantttitle{2016年9月}{30}\\
\gantttitlecalendar{week, day, weekday=shortname} \\
    \foreach \n in {2,3,...,#3}{\ganttbar{}{#1}{#2}\\}
    \ganttbar{}{#1}{#2}
\end{ganttchart}
\end{center}
}

\newpage
\pagenumbering{Roman}
\setcounter{page}{1}

\def\makegantts#1#2{
%\makegantt{#1}{#2}
    \makegantt{#1}{#2}{27}}

\makegantts{2016-10-10}{2016-10-30}
%\makegantts{2016-08-29}{2016-09-25}
%\makegantts{2016-09-26}{2016-10-23}
%\makegantts{2016-10-24}{2016-11-20}
%\makegantts{2016-11-21}{2016-12-18}
%\makegantts{2016-12-19}{2017-01-15}
%
%\makegantts{2017-01-16}{2017-02-12}
%\makegantts{2017-02-13}{2017-03-12}
%\makegantts{2017-03-13}{2017-04-09}
%\makegantts{2017-04-10}{2017-05-07}
%\makegantts{2017-05-08}{2017-06-04}
%\makegantts{2017-05-08}{2017-06-04}
%\makegantts{2017-06-05}{2017-07-02}
%
%\makegantts{2017-07-03}{2017-07-30}
%\makegantts{2017-07-31}{2017-08-27}

\end{document}
