%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% NEU Letter LaTeX Template
% Version 0.1 (02/12/14)
%
% This template has been downloaded from:
% https://github.com/karya0/neuletter
%
% Copyright (C) 2014 by Kapil Arya <kapil@ccs.neu.edu>
%
% License: CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%  2014/02/11 - Initial import
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% neuletter.sty - Northeastern U. letterhead style (for letter class)

% User can define:
% \Name{Sender's name} required
% \Department{Department name, default: CCIS}
% \DeptAddr{Dept addr withing NEU, default: 202 WVH}
% \Phone{phone numner, default: CCIS phone}
% \Fax{fax numner, default: CCIS fax}
% \Email{email addr, default empty}
% \Url{homepage url, default empty} % Unused so far

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{neuletter}[2014/02/11 Northeastern letterhead]
%\RequirePackage[dvips]{graphicx}
%\RequirePackage{graphicx}

\def\sendername{\fromname}

\makeatletter
\def\vhrulefill#1{\leavevmode\leaders\hrule\@height#1\hfill \kern\z@}
\makeatother

\ProcessOptions

% increase the indent for right stuff a little to 55%
\longindentation=.6\textwidth
\indentedwidth=\textwidth
\advance\indentedwidth -\longindentation

\newcommand*{\Name}[1]{\def\sendername{#1}}
\newcommand*{\Department}[1]{\def\deptname{#1}}
\newcommand*{\DeptAddr}[1]{\def\deptaddr{#1}}
\newcommand*{\Phone}[1]{\def\phonenum{#1}}
\newcommand*{\Fax}[1]{\def\faxnum{#1}}
\newcommand*{\Email}[1]{\def\emailaddr{#1}}
\newcommand*{\Url}[1]{\def\urladdr{#1}}

\Department{College of Computer and Information Science}
\DeptAddr{202 West Village H}
\Phone{+1-617-373-2462}
\Fax{+1-617-373-5121}
\Email{}
\Url{}

\def\univaddr{360 Huntington Avenue, Boston, Massachusetts - 02120}

%customization for letter format
%\oddsidemargin   25pt      % Left margin on odd-numbered pages.
%\evensidemargin  25pt      % Left margin on even-numbered pages.
%\textwidth 417pt
%\topmargin -.5in
\parindent 0.3in

\def\ps@headings{\def\@oddhead{\rm To \ignorespaces\toname \hfil \today
    \hfil Page \thepage}\def\@oddfoot{}}

\def\@texttop{\vskip 0pt}

% From address
\address{
  \raggedright \textmd{\LARGE~Northeastern University} \\
  {\small
    \vhrulefill{1.2pt} \\[0.1in]
    \raggedright\hspace{6pt}\univaddr \\
    \vhrulefill{1.2pt} \\[0.1in]
      \renewcommand{\arraystretch}{1.2}
    \begin{tabular}{p{4in} l}
      \sendername   & Phone: \phonenum \\
      \deptname     & Email: \emailaddr \\
      \deptaddr     & Fax: \faxnum \\
    \end{tabular}
  } \\[0.1in]
  \vhrulefill{1.2pt}
}

% To addr
\def\opening#1{\thispagestyle{empty}
{\fromaddress \\[0.2in]
\hspace*{\longindentation}\today\hspace*{\fill}\par}
{\raggedright \toname \\ \toaddress \par}
\vspace{0.4in}
\noindent #1
% Uncomment the 4 lines below to print a footnote with custom text
%\def\thefootnote{}
%\def\footnoterule{\hrule}
%\footnotetext{\hspace*{\fill}{\footnotesize\em Footnote text}}
%\def\thefootnote{\arabic{footnote}}
}

% Signature
\signature{\sendername}

\long\def\closing#1{
\vspace{0.1in}
\noindent
\hspace*{\longindentation}
\parbox{\indentedwidth}{\raggedright
#1
\vskip 0.65in
\fromsig}}

